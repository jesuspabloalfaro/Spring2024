# User-Level and Kernel-Level Threads
## User Threads and Kernel Threads
- **User Threads**
	- Management done by user-level thread library
- Three primary thread libraries
	- POSIX **Pthreads**
	- Windows threads
	- Java threads
- **Kernel Threads**
	- Supported by the Kernel 
- Virtually all general-purpose operating systems support kernel threads
	- Windows, Solaris, Linux, Tru64 UNIX, Mac OS X

## Multithreading Models
- **Many-to-One**
- **One-to-One**
- **Many-to-Many**

## Many-to-One
- *Many* *user-level* threads mapped to *single kernel thread*
- One thread blocking causes all to block
- Multiple threads may *not* run in parallel on multicore systems because only *one* may be in kernel at a time
- Few systems currently use this model
	- Solaris Green Threads (Early Java)
	- GNU Portable Threads

## One-to-One
- *Each* *user-level* thread maps to* kernel* thread
- Creating a user-level thread creates a kernel thread
- More concurrency than many-to-one
	- If a thread blocks, it *does not* block others
	- Can utilize multiprocessing
- Number of threads per process sometimes restricted due to overhead
	- Windows
	- Linux
	- Solaris 9 and later
- Problems include
	- Not setting limit to number of user-level threads because system overhead might be too great

## Many-to-Many
- Allows *many user-level* threads to be mapped to *many kernel level* threads
	- There *does not* have to be a 1-1 number of threads between user and kernel threads
- Allows the operating system to create a sufficient number of kernel threads, application specific or machine specific (more threads on systems with more cores)
- An attempt to mitigate the shortcomings of the other two models

## Two-level Model
- Similar to many-to-many, except that it allows a user thread to be **bound** to kernel thread
- Examples
	- IRIX
	- HP-UX
	- Tru64 UNIX
	- Solaris 8 and earlier
![[Pasted image 20240221201409.png]]

## Thread Libraries
- **Asynchronous Threading**
	- Parent creates child threads and resumes execution
	- Little data sharing (e.g. multi-threaded servers)
- **Synchronous Threading**
	- Parent creates child threads and waits for children to complete (fork-join strategy)
	- Significant data sharing (e.g. parent combines results generated by children)

## Pthreads
- POSIX API for thread creation and synchronization
- **Specification**, *not* **implementation**
	- API *specifies* behavior of thread library, *implementation* is up to library developers
- Common in UNIX operating systems (Solaris, Linux, Mac OS X)

